@model SANSurveyWebAPI.ViewModels.Web.KidsReactTVM

@{
    if (!Request.IsAjaxRequest())
    {
        Layout = "~/Views/Shared/_LayoutKids.cshtml";
    }
    ViewBag.Title = "Survey: Emotional affect";   
}
@using (Html.BeginForm("ReactT", "Kids", FormMethod.Post, new
{ name = "frmReactT", id = "frmReactT", @class = "" }))
{    
   @Html.ValidationSummary(true, "Please check the form for errors.")
    @Html.HiddenFor(model => model.Uid, new { @id = "txtuid" })
    @Html.HiddenFor(model => model.ResponseStartTime)
    @Html.HiddenFor(model => model.KidsLocationId)
    @Html.HiddenFor(model => model.KidsTravelId)
    @Html.HiddenFor(model => model.SurveyDate)
    @Html.HiddenFor(model => model.TaskId)
    @Html.HiddenFor(model => model.TaskName)
    @Html.HiddenFor(model => model.QStartedAt)
    @Html.HiddenFor(model => model.QEndedAt)
    @Html.HiddenFor(model => model.KidsEmoTrackId)

    @Html.HiddenFor(model => model.IsExist, new { @id = "IsExist" })

    <div class="panel panel-default" id="Tasks">
        <div class="panel-heading">
            <h3>
                @if (Model.LongTaskWhile == "location")
                {
                    @Model.PageQuestion
                    <span class="SurveyTitle"> @Model.LongTaskActivity</span><span> at </span>
                    <span class="SurveyTitle">@Model.QLocation</span><span> between </span>
                    <span class="SurveyTitle"> @Model.QStartedAt </span><span> and </span>
                    <span class="SurveyTitle"> @Model.QEndedAt </span>
                    @Model.PageQContd
                }
                else if (Model.LongTaskWhile == "travel" && Model.LongTravelDetails == "during")
                {
                    @Model.PageQuestion
                    <span class="SurveyTitle">@Model.LongNameModeOfTransport</span><span> to </span>
                    <span class="SurveyTitle">@Model.LongFromLocation</span><span> from </span>
                    <span class="SurveyTitle">@Model.LongToLocation</span><span> between </span>
                    <span class="SurveyTitle"> @Model.QStartedAt </span><span> and </span>
                    <span class="SurveyTitle"> @Model.QEndedAt </span>
                    @Model.PageQContd
                }
            </h3>
        </div>            
        <div class="panel-body">
            <div>
                <i>
                    @Model.QuestionHint
                </i>
            </div>
            <div class="form-group row CustomeWellWhite">
                @Html.Label("                           ", new { @class = "col-xs-3 col-form-label" })
                <div id="Q0Panel">
                    <div class="col-xs-9">
                        <div style='text-align:center;'>
                            <input id="CustomeSliderRound" name="CustomeSliderRound" type="text"
                                   data-slider-id="CustomeSliderRound"
                                   data-slider-min="1"
                                   data-slider-max="8"
                                   data-slider-step="1"
                                   data-slider-value="7"
                                   data-slider-tooltip="hide"
                                   data-slider-handle="custom"
                                   data-slider-ticks="[1, 2, 3, 4,5,6,7, 8]"
                                   data-slider-ticks-labels='["Not at all", "","","", "", "", "Extremely",""]' />
                        </div>
                    </div>
                </div>
            </div>
            <div id="Q6Panel" class="form-group row CustomeWellWhite">
                <div>
                    <label class="col-xs-3 col-form-label CustomRatingLabel">
                        (6/11) &nbsp;&nbsp;
                        Warm/ friendly
                    </label>
                    <div class="col-xs-9">
                        <div style='text-align:center;'>
                            <br />
                            <input id="Q6Ans" name="Q6Ans" type="text"
                                   data-slider-min="0"
                                   data-slider-max="7"
                                   data-slider-step="1"
                                   data-slider-ticks="[0, 1, 2, 3,4,5,6,7]"
                                   data-slider-ticks-labels='["0", "1", "2", "3", "4","5","6","N/A"]'
                                   data-slider-value=@Model.Q6Ans />
                        </div>
                        <small id="Q6Ans_Incomplete" class="invalid pull-right hidden"><i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp;Incomplete</small>
                 </div>
                </div>
            </div>
            <div id="Q7Panel" class="form-group row CustomeWellGray">
                <div>
                    <label class="col-xs-3 col-form-label CustomRatingLabel">
                        (7/11) &nbsp;&nbsp;
                        Worried/ anxious
                    </label>
                    <div class="col-xs-9">
                        <div style='text-align:center;'>
                            <br />
                            <input id="Q7Ans" name="Q7Ans" type="text"
                                   data-slider-min="0"
                                   data-slider-max="7"
                                   data-slider-step="1"
                                   data-slider-ticks="[0, 1, 2, 3,4,5,6,7]"
                                   data-slider-ticks-labels='["0", "1", "2", "3", "4","5","6","N/A"]'
                                   data-slider-value=@Model.Q7Ans />
                        </div>
                        <small id="Q7Ans_Incomplete" class="invalid pull-right hidden"><i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp;Incomplete</small>
                    </div>
                </div>
            </div>
            <div id="Q8Panel" class="form-group row CustomeWellWhite">
                <div>
                    <label class="col-xs-3 col-form-label CustomRatingLabel">
                        (8/11) &nbsp;&nbsp;
                        Enjoying myself
                    </label>
                    <div class="col-xs-9">
                        <div style='text-align:center;'>
                            <br />
                            <input id="Q8Ans" name="Q8Ans" type="text"
                                   data-slider-min="0"
                                   data-slider-max="7"
                                   data-slider-step="1"
                                   data-slider-ticks="[0, 1, 2, 3,4,5,6,7]"
                                   data-slider-ticks-labels='["0", "1", "2", "3", "4","5","6","N/A"]'
                                   data-slider-value=@Model.Q8Ans />
                        </div>
                        <small id="Q8Ans_Incomplete" class="invalid pull-right hidden"><i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp;Incomplete</small>
                    </div>
                </div>
            </div>
            <div id="Q9Panel" class="form-group row CustomeWellGray">
                <div>
                    <label class="col-xs-3 col-form-label CustomRatingLabel">
                        (9/11) &nbsp;&nbsp;
                        Criticised / put down
                    </label>
                    <div class="col-xs-9">
                        <div style='text-align:center;'>
                            <br />
                            <input id="Q9Ans" name="Q9Ans" type="text"
                                   data-slider-min="0"
                                   data-slider-max="7"
                                   data-slider-step="1"
                                   data-slider-ticks="[0, 1, 2, 3,4,5,6,7]"
                                   data-slider-ticks-labels='["0", "1", "2", "3", "4","5","6","N/A"]'
                                   data-slider-value=@Model.Q9Ans />
                        </div>
                        <small id="Q9Ans_Incomplete" class="invalid pull-right hidden"><i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp;Incomplete</small>
                    </div>
                </div>
            </div>
            <div id="Q10Panel" class="form-group row CustomeWellWhite">
                <div>
                    <label class="col-xs-3 col-form-label CustomRatingLabel">
                        (10/11) &nbsp;&nbsp;
                        Tired
                    </label>
                    <div class="col-xs-9">
                        <div style='text-align:center;'>
                            <br />
                            <input id="Q10Ans" name="Q10Ans" type="text"
                                   data-slider-min="0"
                                   data-slider-max="7"
                                   data-slider-step="1"
                                   data-slider-ticks="[0, 1, 2, 3,4,5,6,7]"
                                   data-slider-ticks-labels='["0", "1", "2", "3", "4","5","6","N/A"]'
                                   data-slider-value=@Model.Q10Ans />
                        </div>
                        <small id="Q10Ans_Incomplete" class="invalid pull-right hidden"><i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp;Incomplete</small>
                    </div>
                </div>
            </div>
            <div id="Q12Panel" class="form-group row CustomeWellGray">
                <div>
                    <label class="col-xs-3 col-form-label CustomRatingLabel">
                        (11/11) &nbsp;&nbsp;
                        Safe
                    </label>
                    <div class="col-xs-9">
                        <div style='text-align:center;'>
                            <br />
                            <input id="Q12Ans" name="Q12Ans" type="text"
                                   data-slider-min="0"
                                   data-slider-max="7"
                                   data-slider-step="1"
                                   data-slider-ticks="[0, 1, 2, 3,4,5,6,7]"
                                   data-slider-ticks-labels='["0", "1", "2", "3", "4","5","6","N/A"]'
                                   data-slider-value=@Model.Q12Ans />
                        </div>
                        <small id="Q12Ans_Incomplete" class="invalid pull-right hidden"><i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp;Incomplete</small>
                    </div>
                </div>
            </div>
        </div>
        <center>
            <div style="padding:10px">
                <button class="btn btn-success btn-lg" id="btnNext" type="submit">Next&nbsp;&nbsp;<i class="fa fa-angle-right" aria-hidden="true"></i></button>
            </div>
        </center>
    </div>    
    @Html.Partial("_DialogRating2")
    @Html.Partial("_FooterSurvey")   
}


<style>
    #Q0Panel {
        pointer-events: none;
    }
</style>
<script src="~/Scripts/StopBack/StopBackBrowserButton.js"></script>
<script>
    var inst = $("#_DialogRating2").remodal();

    function RemoveCustomValidation() {
        $('#Q6Ans_Incomplete').addClass('hidden');
        $('#Q7Ans_Incomplete').addClass('hidden');
        $('#Q8Ans_Incomplete').addClass('hidden');
        $('#Q9Ans_Incomplete').addClass('hidden');
        $('#Q10Ans_Incomplete').addClass('hidden');
        $('#Q12Ans_Incomplete').addClass('hidden');
    }
    function AddCustomValidation() {
        var Q6Ans = $("#Q6Ans").slider('getValue');
        var Q7Ans = $("#Q7Ans").slider('getValue');
        var Q8Ans = $("#Q8Ans").slider('getValue');
        var Q9Ans = $("#Q9Ans").slider('getValue');
        var Q10Ans = $("#Q10Ans").slider('getValue');
        var Q12Ans = $("#Q12Ans").slider('getValue');

        if (Q6Ans == "7") {
            $('#Q6Ans_Incomplete').removeClass('hidden');
        }
        else {
            $('#Q6Ans_Incomplete').addClass('hidden');
        }
        if (Q7Ans == "7") {
            $('#Q7Ans_Incomplete').removeClass('hidden');
        }
        else {
            $('#Q7Ans_Incomplete').addClass('hidden');
        }
        if (Q8Ans == "7") {
            $('#Q8Ans_Incomplete').removeClass('hidden');
        }
        else {
            $('#Q8Ans_Incomplete').addClass('hidden');
        }
        if (Q9Ans == "7") {
            $('#Q9Ans_Incomplete').removeClass('hidden');
        }
        else {
            $('#Q9Ans_Incomplete').addClass('hidden');
        }
        if (Q10Ans == "7") {
            $('#Q10Ans_Incomplete').removeClass('hidden');
        }
        else {
            $('#Q10Ans_Incomplete').addClass('hidden');
        }
        if (Q12Ans == "7") {
            $('#Q12Ans_Incomplete').removeClass('hidden');
        }
        else {
            $('#Q12Ans_Incomplete').addClass('hidden');
        }
    }

    function AllUnAnswered() {

        var Q6Ans = $("#Q6Ans").slider('getValue');
        var Q7Ans = $("#Q7Ans").slider('getValue');
        var Q8Ans = $("#Q8Ans").slider('getValue');
        var Q9Ans = $("#Q9Ans").slider('getValue');
        var Q10Ans = $("#Q10Ans").slider('getValue');
        var Q12Ans = $("#Q12Ans").slider('getValue');

        if (Q6Ans == "7"
            && Q7Ans == "7" && Q8Ans == "7" && Q9Ans == "7" && Q10Ans == "7" && Q12Ans == "7"
            ) {
            return true;
        }
        else {
            return false;
        }
    }

    function EitherUnAnswered() {

        var Q6Ans = $("#Q6Ans").slider('getValue');
        var Q7Ans = $("#Q7Ans").slider('getValue');
        var Q8Ans = $("#Q8Ans").slider('getValue');
        var Q9Ans = $("#Q9Ans").slider('getValue');
        var Q10Ans = $("#Q10Ans").slider('getValue');
        var Q12Ans = $("#Q12Ans").slider('getValue');

        if (Q6Ans == "7"
           && Q7Ans == "7" || Q8Ans == "7" || Q9Ans == "7" || Q10Ans == "7" || Q12Ans == "7"
           ) {
            return true;
        }
        else {
            return false;
        }
    }

    $(document).on('confirmation', '#_DialogRating2', function () {
        RemoveCustomValidation();
        inst.destroy();
        $('#frmReactT').submit();
    });

    $(document).on('cancellation', '#_DialogRating2', function () {
        AddCustomValidation();
    });


    function OnSuccess(response) {
        if (response == "") {
            window.location.href = "@Url.Action("ConnectionError", "Survey3")";
        }
        else {
        }
    }
    function OnFailure(response) {
        alert("Oops! submission failed. Please ensure you are connected to the network.");
    }

    var isExist = $("#IsExist").val();

    $(document).ready(function () {
        function GetText5ScaleRatingJS(value) {
            switch (value) {
                case 0:
                    return "Not at all"
                case 1:
                    return "Slightly"
                case 2:
                    return "Somewhat"
                case 3:
                    return "Moderately"
                case 4:
                    return "Strongly"
                case 5:
                    return "Very Strongly"
                case 6:
                    return "Extremely"
                case 7:
                    return "N/A"
                default:
                    return "N/A"
            }
        }
        var topSlider = $('#CustomeSliderRound').slider({           
        });

        $('#Q6Ans').slider({
            tooltip: 'always',
            formatter: function (value) {
                return GetText5ScaleRatingJS(value);
            }
        }).on('change', function (event) {
            $("#Q7Panel").slideDown("slow", function () {
            });
        });

        $('#Q7Ans').slider({
            tooltip: 'always',
            formatter: function (value) {
                return GetText5ScaleRatingJS(value);
            }
        }).on('change', function (event) {
            $("#Q8Panel").slideDown("slow", function () {
            });
        });

        $('#Q8Ans').slider({
            tooltip: 'always',
            formatter: function (value) {
                return GetText5ScaleRatingJS(value);
            }
        }).on('change', function (event) {
            $("#Q9Panel").slideDown("slow", function () {
            });
        });

        $('#Q9Ans').slider({
            tooltip: 'always',
            formatter: function (value) {
                return GetText5ScaleRatingJS(value);
            }
        }).on('change', function (event) {
            $("#Q10Panel").slideDown("slow", function () {
            });
        });

        //$('#Q10Ans').slider({
        //    tooltip: 'always',
        //    formatter: function (value) {
        //        return GetText5ScaleRatingJS(value);
        //    }
        //}).on('change', function (event) {
        //    $("#btnNext").removeAttr("disabled");
        //});
        $('#Q10Ans').slider({
            tooltip: 'always',
            formatter: function (value) {
                return GetText5ScaleRatingJS(value);
            }
        }).on('change', function (event) {
            $("#Q12Panel").slideDown("slow", function () {
            });
        });

        $('#Q12Ans').slider({
            tooltip: 'always',
            formatter: function (value) {
                return GetText5ScaleRatingJS(value);
            }
        }).on('change', function (event) {
            $("#btnNext").removeAttr("disabled");
        });

        if (isExist == 'False') {
            $("#Q7Panel").hide();
            $("#Q8Panel").hide();
            $("#Q9Panel").hide();
            $("#Q10Panel").hide();
            $("#Q12Panel").hide();
            $("#btnNext").attr("disabled", true);
        }
        else {
            $("#btnNext").removeAttr("disabled");
        }
        $('#btnNext').on("click", function (e) {
            e.preventDefault();
            if (AllUnAnswered()) {
                AddCustomValidation();
            }
            else if (EitherUnAnswered()) {
                inst.open();
            }
            else {
                $('#frmReactT').submit();
            }
        });

    });

</script>



